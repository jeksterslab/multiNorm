---
title: "Generating Sample Mean Vectors from the Multivariate Normal Distribution Using the Cholesky Decomposition"
author: "Ivan Jacob Agaloos Pesigan"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Generating Sample Mean Vectors from the Multivariate Normal Distribution Using the Cholesky Decomposition}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(multiNorm)
```

The multivariate normal distribution is given by

\begin{equation}
    \mathcal{N}
    \left(
      \boldsymbol{\mu},
      \boldsymbol{\Sigma}
    \right)
    \label{eq:mvn}
\end{equation}

When data is randomly sampled from the multivariate normal distribution,
the sample mean vector $\bar{\mathbf{x}}_{n}$,
where $n$ is the sample size,
is given by

\begin{equation}
    \bar{\mathbf{x}}_{n} \sim \mathcal{N} \left( \boldsymbol{\mu}, n^{-1} \boldsymbol{\Sigma} \right)
    \label{eq:means-mvn}
\end{equation}

Sample means can be generated from the multivariate normal distribution
using Equation \ref{eq:means-mvn}.

```{r}
set.seed(42)
n_i <- 1000
rcap_i <- 10
k_i <- sample(x = 2:10, size = 1)
mu_i <- rep(x = 0, times = k_i)
sigmacap_i <- toeplitz((k_i:1) / k_i)
theta_i <- c(
  mu_i,
  vech(sigmacap_i)
)
mu_i
sigmacap_i
sigmacap_i / n_i
theta_i
```

## rmeans\_mvn\_chol

```{r}
data_i <- rmeans_mvn_chol(
  rcap = rcap_i,
  mu = mu_i,
  sigmacap = sigmacap_i,
  n = n_i
)
data_i
colMeans(data_i)
cov(data_i)
```

## rmeans\_mvn\_chol\_of\_theta

```{r}
data_i <- rmeans_mvn_chol_of_theta(
  rcap = rcap_i,
  x = theta_i,
  n = n_i
)
data_i
colMeans(data_i)
cov(data_i)
```

<<echo = FALSE>>=
rm(
  data_i,
  k_i,
  mu_i,
  n_i,
  rcap_i,
  sigmacap_i,
  theta_i
)
```
