---
title: "Generating Multivariate Normal Data Using the Cholesky Decomposition"
author: "Ivan Jacob Agaloos Pesigan"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Generating Multivariate Normal Data Using the Cholesky Decomposition}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(multiNorm)
```

The multivariate normal distribution is given by

\begin{equation}
    \mathcal{N}
    \left(
      \boldsymbol{\mu},
      \boldsymbol{\Sigma}
    \right)
    \label{eq:mvn}
\end{equation}

\noindent where
$\boldsymbol{\mu}$ is a $k \times 1$
vector of means,
and
$\boldsymbol{\Sigma}$ is a $k \times k$
matrix of variances on the diagonals
and covariances on the off-diagonals.

Multivariate normal data can be generated
using

\begin{equation}
  \mathbf{Z} \mathbf{Q} + 1_n \boldsymbol{\mu}
    \label{eq:rmvn-chol}
\end{equation}

\noindent where
$\mathbf{Z}$ is an $n \times k$ matrix of random variates
from the standard normal distribution,
$\mathbf{Q}$ is the upper triangular factor
of the Cholesky decomposition
given by
$\boldsymbol{\Sigma} = \mathbf{Q}^{\prime} \mathbf{Q}$
where $\boldsymbol{\Sigma}$ is the covariance matrix,
$1_n$ is an $n \times 1$ column vector of ones,
and $\boldsymbol{\mu}$ is the mean vector.


```{r}
set.seed(42)
n_i <- 1000000
k_i <- sample(x = 2:10, size = 1)
mu_i <- rep(x = 0, times = k_i)
rho_i <- runif(n = 1, min = -1, max = 1)
sigmacap_i <- matrix(
  data = rho_i,
  nrow = k_i,
  ncol = k_i
)
diag(sigmacap_i) <- 1
vech_i <- vech(sigmacap_i)
rhocap_i <- cov2cor(sigmacap_i)
vechs_i <- vechs(rhocap_i)
mu_i
sigmacap_i
vech_i
rhocap_i
vechs_i
```

## rmvn\_chol

```{r}
data_i <- rmvn_chol(
  n = n_i,
  mu = mu_i,
  sigmacap = sigmacap_i
)
colMeans(data_i)
cov(data_i)
```

## rmvn\_theta

```{r}
theta_i <- c(
  mu_i,
  vech(sigmacap_i)
)
data_i <- rmvn_chol_of_theta(
  n = n_i,
  x = theta_i
)
colMeans(data_i)
cov(data_i)
```

## rmvn\_chol\_of\_rhocap

```{r}
data_i <- rmvn_chol_of_rhocap(
  n = n_i,
  x = rhocap_i
)
colMeans(data_i)
cov(data_i)
```

## rmvn\_chol\_of\_vechsrhocap

```{r}
data_i <- rmvn_chol_of_vechsrhocap(
  n = n_i,
  x = vechs_i
)
colMeans(data_i)
cov(data_i)
```
