---
title: "Generating Sample Covariance Matrices from the Wishart Distribution"
author: "Ivan Jacob Agaloos Pesigan"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Generating Sample Covariance Matrices from the Wishart Distribution}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(multiNorm)
```

The multivariate normal distribution is given by

\begin{equation}
    \mathcal{N}
    \left(
      \boldsymbol{\mu},
      \boldsymbol{\Sigma}
    \right)
    \label{eq:mvn}
\end{equation}

\noindent where
$\boldsymbol{\mu}$ is a $k \times 1$
vector of means,
and
$\boldsymbol{\Sigma}$ is a $k \times k$
matrix of variances on the diagonals
and covariances on the off-diagonals.

The Wishart distribution is given by

\begin{equation}
    \mathcal{W} \left( \mathbf{V}, n \right)
    \label{eq:wishart}
\end{equation}

\noindent where
$\mathbf{V}$ is a $k \times k$ positive definite matrix,
and
$n$ is the degrees of freedom.

When data is randomly sampled from the multivariate normal distribution,
the unbiased sample covariance matrix $S_{n - 1}$,
where $n$ is the sample size
and $n - 1$ is the degrees of freedom,
is given by

\begin{equation}
    \left( n - 1 \right) S_{n - 1}
    \sim
    \mathcal{W} \left( \boldsymbol{\Sigma}, n - 1 \right)
    \label{eq:vcov-wishart}
\end{equation}

Sample covariances can be generated from the Wishart distribution using

\begin{equation}
    \left( n - 1 \right)^{-1} \mathcal{W} \left( \boldsymbol{\Sigma}, n - 1 \right)
    \label{eq:vcov-inv-wishart}
\end{equation}

```{r}
set.seed(42)
n_i <- 1000
df_i <- n_i - 1
rcap_i <- 10
k_i <- sample(x = 2:10, size = 1)
sigmacap_i <- toeplitz((k_i:1) / k_i)
vech_i <- vech(sigmacap_i)
sigmacap_i
vech_i
df_i
```

## rvcov\_wishart

```{r}
data_i <- rvcov_wishart(
  rcap = rcap_i,
  sigmacap = sigmacap_i,
  df = df_i,
  list = TRUE
)
data_i
```

```{r}
data_i <- rvcov_wishart(
  rcap = rcap_i,
  sigmacap = sigmacap_i,
  df = df_i,
  list = FALSE,
  vec = TRUE
)
data_i
```

```{r}
data_i <- rvcov_wishart(
  rcap = rcap_i,
  sigmacap = sigmacap_i,
  df = df_i,
  list = FALSE,
  vec = FALSE
)
data_i
```

## rvcov\_wishart\_of\_vechsigmacap

```{r}
data_i <- rvcov_wishart_of_vechsigmacap(
  rcap = rcap_i,
  x = vech_i,
  df = df_i
)
data_i
```

```{r}
data_i <- rvcov_wishart_of_vechsigmacap(
  rcap = rcap_i,
  x = vech_i,
  df = df_i
)
data_i
```
